<table id="t-i" class="list" width="100%">
    <tbody>
        <tr class="top-table" style="height: 25px;">
            <th width="10%" rowspan="2">Plate Id</th>
            <th width="8%" rowspan="2">Steel Grade</th>
            <th width="7%" rowspan="2">Thickness,<br>{$dimension_unit}</th>
            <th width="7%" rowspan="2">Width,<br>{$dimension_unit}</th>
            <th width="7%" rowspan="2">Length,<br>{$dimension_unit}</th>
            <th width="7%" rowspan="2">Weight,<br>{$weight_unit|wunit}</th>
            <th colspan="4" style="border-bottom : 1px solid #B9B9B9;">Measured</th>
            <th colspan="2" style="border-bottom : 1px solid #B9B9B9;">Transport</th>
            <th width="7%" rowspan="2">Weighed Weight,<br>{$position.steelposition.weight_unit|wunit}</th>                        
            <th width="5%" rowspan="2">Is Virtual</th>
            <th width="2%" rowspan="2">System<br>Id</th>            
        </tr>
        <tr class="top-table" style="height: 25px;">
            <th width="7%">Thickness,<br>{$dimension_unit}</th>
            <th width="7%">Width,<br>{$dimension_unit}</th>
            <th width="7%">Length,<br>{$dimension_unit}</th>
            <th width="7%">Weight,<br>{$weight_unit|wunit}</th>
            <th width="7%">Width,<br>{$dimension_unit}</th>
            <th width="7%">Length,<br>{$dimension_unit}</th>
        </tr>        
        {foreach name=i from=$items item=row}
        <tr>
        {if $row.steelitem.inuse || $row.steelitem.parent_id > 0}
            <td>{if !empty($row.steelitem.guid)}{$row.steelitem.guid|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.steelgrade)}{$row.steelitem.steelgrade.title|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.thickness)}{$row.steelitem.thickness|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.width)}{$row.steelitem.width|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.length)}{$row.steelitem.length|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.unitweight)}{$row.steelitem.unitweight|escape:'html'|string_format:'%.2f'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.thickness_measured)}{$row.steelitem.thickness_measured|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.width_measured)}{$row.steelitem.width_measured|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.length_measured)}{$row.steelitem.length_measured|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if $row.steelitem.unitweight_measured > 0}{$row.steelitem.unitweight_measured|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.width_max)}{$row.steelitem.width_max|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.length_max)}{$row.steelitem.length_max|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if $row.steelitem.unitweight_weighed > 0}{$row.steelitem.unitweight_weighed|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.is_virtual)}yes{else}no{/if}</td>
            <td>{if $row.steelitem.parent_id > 0}<a href="/item/edit/{$row.steelitem.parent_id}"><img src="/img/icons/lock.png" title="{$row.steelitem.rel_title}" alt="{$row.steelitem.rel_title}"></a>{else}<img src="/img/icons/lock.png" title="{$row.steelitem.inuse_by}" alt="{$row.steelitem.inuse_by}">{/if}</td>            
        {else}
            <td>
                <input type="text" id="guid-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][guid]" value="{if !empty($row.steelitem.guid)}{$row.steelitem.guid|escape:'html'}{/if}" style="width: 100%;" onkeyup="change_is_virtual({$smarty.foreach.i.index + 1});">
                <input type="hidden" id="t-i-deleted-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][is_deleted]" value="{if isset($row.steelitem.is_deleted)}{$row.steelitem.is_deleted|escape:'html'}{else}0{/if}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][steelposition_id]" value="{$row.steelitem.steelposition_id}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][product_id]" value="{$row.steelitem.product_id}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][dimension_unit]" value="{$row.steelitem.dimension_unit}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][weight_unit]" value="{$row.steelitem.weight_unit}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][currency]" value="{$row.steelitem.currency}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][biz_id]" value="{$row.steelitem.biz_id}">
                <input type="hidden" name="item[{$smarty.foreach.i.index + 1}][price]" value="{$row.steelitem.price}">
            </td>
            <td>
                <select name="item[{$smarty.foreach.i.index + 1}][steelgrade_id]" style="width: 100%;">
                    <option value="0">--</option>
                    {foreach from=$steelgrades item=sgrow}
                    <option value="{$sgrow.steelgrade.id}"{if $row.steelitem.steelgrade_id == $sgrow.steelgrade.id} selected="selected"{/if}>{$sgrow.steelgrade.title|escape:'html'}</option>
                    {/foreach}                    
                </select>
            </td>
            <td><input type="text" id="i-thickness-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][thickness]" value="{if !empty($row.steelitem.thickness)}{$row.steelitem.thickness|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'i');"></td>
            <td><input type="text" id="i-width-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][width]" value="{if !empty($row.steelitem.width)}{$row.steelitem.width|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'i');"></td>
            <td><input type="text" id="i-length-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][length]" value="{if !empty($row.steelitem.length)}{$row.steelitem.length|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'i');"></td>
            <td><input type="text" id="i-unitweight-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][unitweight]" value="{if !empty($row.steelitem.unitweight)}{$row.steelitem.unitweight|escape:'html'|string_format:'%.2f'}{/if}" style="width: 100%;"></td>
            <td><input type="text" id="measured-thickness-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][thickness_measured]" value="{if !empty($row.steelitem.thickness_measured)}{$row.steelitem.thickness_measured|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'measured');"></td>
            <td><input type="text" id="measured-width-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][width_measured]" value="{if !empty($row.steelitem.width_measured)}{$row.steelitem.width_measured|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'measured');"></td>
            <td><input type="text" id="measured-length-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][length_measured]" value="{if !empty($row.steelitem.length_measured)}{$row.steelitem.length_measured|escape:'html'}{/if}" style="width: 100%;" onkeyup="calc_unitweight({$smarty.foreach.i.index + 1}, '{$row.steelitem.dimension_unit}', '{$row.steelitem.weight_unit}', 'measured');"></td>
            <td><input type="text" id="measured-unitweight-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][unitweight_measured]" value="{if $row.steelitem.unitweight_measured > 0}{$row.steelitem.unitweight_measured|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][width_max]" value="{if !empty($row.steelitem.width_max)}{$row.steelitem.width_max|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][length_max]" value="{if !empty($row.steelitem.length_max)}{$row.steelitem.length_max|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][unitweight_weighed]" value="{if $row.steelitem.unitweight_weighed > 0}{$row.steelitem.unitweight_weighed|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="checkbox" id="is_virtual-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][is_virtual]" value="1"{if !empty($row.steelitem.is_virtual)} checked="checked"{/if}></td>
            <td>{if empty($row.steelitem.id)}*{else}{$row.steelitem.id}{/if}<input type="hidden" id="t-i-id-{$smarty.foreach.i.index + 1}" name="item[{$smarty.foreach.i.index + 1}][id]" value="{$row.steelitem.id}"></td>            
        {/if}
        </tr>        
        {/foreach}
    </tbody>    
</table>
<div class="pad"></div>

<h3>Location</h3>
<table id="t-il" class="list" width="100%">
    <tbody>
        <tr class="top-table" style="height: 25px;">
            <th width="2%" rowspan="2">Id</th>
            <th colspan="3" style="border-bottom : 1px solid #B9B9B9;">Supplier Invoice</th>
            <th colspan="3" style="border-bottom : 1px solid #B9B9B9;">Incoming DDT</th>
            <th colspan="3" style="border-bottom : 1px solid #B9B9B9;">Outgoing DDT</th>
            <th rowspan="2">Owner</th>
            <th rowspan="2">Location</th>
        </tr>
        <tr class="top-table" style="height: 25px;">
            <th width="80px">Number</th>
            <th width="80px">Date</th>
            <th>Company</th>
            <th width="80px">Number</th>
            <th width="80px">Date</th>
            <th>Company</th>
            <th width="80px">Number</th>
            <th width="80px">Date</th>
            <th>Company</th>
        </tr>
        {foreach name=i from=$items item=row}
        <tr>
        {if $row.steelitem.inuse || $row.steelitem.parent_id > 0}
            <td>{if $row.steelitem.parent_id > 0}<a href="/item/edit/{$row.steelitem.parent_id}"><img src="/img/icons/lock.png" title="{$row.steelitem.rel_title}" alt="{$row.steelitem.rel_title}"></a>{else}<img src="/img/icons/lock.png" title="{$row.steelitem.inuse_by}" alt="{$row.steelitem.inuse_by}">{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.number|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.date|date_format:'d/m/Y'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.company.doc_no}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.in_ddt_number)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_number|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.in_ddt_date)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_date|escape:'html'|date_format:'d/m/Y'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.in_ddt_company)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_company.doc_no|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.ddt_number)}{$row.steelitem.ddt_number|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.ddt_date)}{$row.steelitem.ddt_date|escape:'html'|date_format:'d/m/Y'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.ddt_company)}{$row.steelitem.ddt_company.doc_no|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.owner)}{$row.steelitem.owner.title_trade|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.stockholder)}{$row.steelitem.stockholder.title|escape:'html'}{else}{''|undef}{/if}</td>
        {else}
            <td>{if empty($row.steelitem.id)}*{else}{$row.steelitem.id}{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.number|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.date|date_format:'d/m/Y'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.supplier_invoice)}<a href="/supplierinvoice/{$row.steelitem.supplier_invoice_id}">{$row.steelitem.supplier_invoice.company.doc_no}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.in_ddt_number)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_number|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.in_ddt_date)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_date|escape:'html'|date_format:'d/m/Y'}</a>{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.in_ddt_company)}<a href="/inddt/{$row.steelitem.in_ddt_id}">{$row.steelitem.in_ddt_company.doc_no|escape:'html'}</a>{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.ddt_number)}{$row.steelitem.ddt_number|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.ddt_date)}{$row.steelitem.ddt_date|escape:'html'|date_format:'d/m/Y'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.ddt_company)}{$row.steelitem.ddt_company.doc_no|escape:'html'|date_format:'d/m/Y'}{else}{''|undef}{/if}</td>
            <td>{if isset($row.steelitem.owner)}{$row.steelitem.owner.title_trade|escape:'html'}{else}{''|undef}{/if}</td>
            <td>
                {if empty($row.steelitem.supplier_invoice_id) && empty($row.steelitem.in_ddt_id) && $row.steelitem.status_id <= $smarty.const.ITEM_STATUS_STOCK}
                <select name="item[{$smarty.foreach.i.index + 1}][location_id]" class="max">
                    <option value="0"{if empty($row.steelitem.stockholder_id)} selected="selected"{/if}>--</option>
                    {foreach from=$row.locations item=location}
                    <option value="{$location.company.id}"{if $row.steelitem.stockholder_id == $location.company.id} selected="selected"{/if}>{$location.company.doc_no|escape:'html'} ({if isset($location.company.stocklocation.title)}{$location.company.stocklocation.title|escape:'html'}{/if}{if isset($location.company.city) && (isset($location.company.stocklocation) && $location.company.stocklocation.title != $location.company.city.title)}, {$location.company.city.title}{/if})</option>
                    {/foreach}
                </select>
                {elseif isset($row.steelitem.stockholder)}{$row.steelitem.stockholder.title|escape:'html'}
                {else}{''|undef}{/if}
            </td>
        {/if}
        </tr>
        {/foreach}
    </tbody>
</table>
<div class="pad"></div>

<h3>Status</h3>
<table id="t-is" class="list" width="100%">
    <tbody>
        <tr class="top-table">
            <th width="2%">Id</th>
            <th width="10%">Mill</th>
            {* <th width="10%">System</th> *}
            <th width="7%">Purchase Price,<br>per {$weight_unit|wunit}</th>
            <th width="7%">Current Cost,<br>{$currency}/{$weight_unit|wunit}</th>
            <th width="7%">P/L,<br>{$currency}/{$weight_unit|wunit}</th>
            <th width="7%">Days On Stock</th>
            <th width="10%">Status</th>
            <th width="15%">Load Ready</th>
            <th>Internal Notes</th>
        </tr>
        {foreach name=i from=$items item=row}
        <tr>
        {if $row.steelitem.inuse || $row.steelitem.parent_id > 0}
            <td>{if $row.steelitem.parent_id > 0}<a href="/item/edit/{$row.steelitem.parent_id}"><img src="/img/icons/lock.png" title="{$row.steelitem.rel_title}" alt="{$row.steelitem.rel_title}"></a>{else}<img src="/img/icons/lock.png" title="{$row.steelitem.inuse_by}" alt="{$row.steelitem.inuse_by}">{/if}</td>
            <td>{if !empty($row.steelitem.mill)}{$row.steelitem.mill|escape:'html'}{else}{''|undef}{/if}</td>
            {*<td>{if !empty($row.steelitem.system)}{$row.steelitem.system|escape:'html'}{/if}</td>*}
            <td>{if $row.steelitem.purchase_price > 0}{if !empty($row.steelitem.purchase_currency)}{$row.steelitem.purchase_currency|cursign} {/if}{$row.steelitem.purchase_price|string_format:'%.2f'}{else}{''|undef}{/if}</td>
            <td>{if $row.steelitem.current_cost != 0}{$row.steelitem.current_cost|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if $row.steelitem.pl != 0}{$row.steelitem.pl|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{$row.steelitem.days_on_stock}</td>
            <td>
                {if empty($row.steelitem.status_id)}{''|undef}
                {else}
                    {$row.steelitem.status_title}
                    {if $row.steelitem.order_id > 0}<br><a href="/order/{$row.steelitem.order_id}">{$row.steelitem.order_id|order_doc_no}</a>{/if}
                {/if}
            </td>
            <td>{if !empty($row.steelitem.load_ready)}{$row.steelitem.load_ready|escape:'html'}{else}{''|undef}{/if}</td>
            <td>{if !empty($row.steelitem.parent_id)}<a href="/item/edit/{$row.steelitem.parent_id}">{$row.steelitem.rel_title}</a>{else}{if !empty($row.steelitem.internal_notes)}{$row.steelitem.internal_notes|escape:'html'}{else}{''|undef}{/if}{/if}</td>
        {else}
            <td>{if empty($row.steelitem.id)}*{else}{$row.steelitem.id}{/if}</td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][mill]" value="{if !empty($row.steelitem.mill)}{$row.steelitem.mill|escape:'html'}{/if}" style="width: 100%;"></td>
            {*<td><input type="text" name="item[{$smarty.foreach.i.index + 1}][system]" value="{if !empty($row.steelitem.system)}{$row.steelitem.system|escape:'html'}{/if}" style="width: 100%;"></td>*}
            <td>{if $row.steelitem.purchase_price > 0}{if !empty($row.steelitem.purchase_currency)}{$row.steelitem.purchase_currency|cursign} {/if}{$row.steelitem.purchase_price|string_format:'%.2f'}{/if}</td>            
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][current_cost]" value="{if $row.steelitem.current_cost != 0}{$row.steelitem.current_cost|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][pl]" value="{if $row.steelitem.pl != 0}{$row.steelitem.pl|escape:'html'}{/if}" style="width: 100%;"></td>
            <td>{$row.steelitem.days_on_stock}</td>
            <td>
                {if $row.steelitem.status_id > $smarty.const.ITEM_STATUS_STOCK}
                    {$row.steelitem.status_title|escape:'html'}
                    {if $row.steelitem.order_id > 0}<br><a href="/order/{$row.steelitem.order_id}">{$row.steelitem.order_id|order_doc_no}</a>{/if}
                {else}                
                <select name="item[{$smarty.foreach.i.index + 1}][status_id]" style="width: 100%;">
                    <option value="0"{if empty($row.steelitem.status_id)} selected="selected"{/if}>--</option>
                    <option value="{$smarty.const.ITEM_STATUS_PRODUCTION}"{if $row.steelitem.status_id == $smarty.const.ITEM_STATUS_PRODUCTION} selected="selected"{/if}>In Production</option>
                    <option value="{$smarty.const.ITEM_STATUS_TRANSFER}"{if $row.steelitem.status_id == $smarty.const.ITEM_STATUS_TRANSFER} selected="selected"{/if}>Transfer To Stock</option>
                    <option value="{$smarty.const.ITEM_STATUS_STOCK}"{if $row.steelitem.status_id == $smarty.const.ITEM_STATUS_STOCK} selected="selected"{/if}>On Stock</option>
                </select>
                {/if}
            </td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][load_ready]" value="{if !empty($row.steelitem.load_ready)}{$row.steelitem.load_ready|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item[{$smarty.foreach.i.index + 1}][internal_notes]" value="{if !empty($row.steelitem.internal_notes)}{$row.steelitem.internal_notes|escape:'html'}{/if}" style="width: 100%;"></td>
        {/if}
        </tr>
        {/foreach}
    </tbody>
</table>
<div class="pad"></div>

<h3>Chemical Analysis</h3>
<table id="t-ic" class="list" width="100%">
    <tbody>
        <tr class="top-table">
            <th width="2%">Id</th>
            <th>Heat / Lot</th>
            <th>%C</th>
            <th>%Si</th>
            <th>%Mn</th>
            <th>%P</th>
            <th>%S</th>
            <th>%Cr</th>
            <th>%Ni</th>
            <th>%Cu</th>
            <th>%Al</th>
            <th>%Mo</th>
            <th>%Nb</th>
            <th>%V</th>
            <th>%N</th>
            <th>%Ti</th>
            <th>%Sn</th>
            <th>%B</th>
            <th>CEQ</th>
        </tr>
        {foreach name=i from=$items item=row}
        <tr>
        {if $row.steelitem.inuse || $row.steelitem.parent_id > 0}
            <td>{if $row.steelitem.parent_id > 0}<a href="/item/edit/{$row.steelitem.parent_id}"><img src="/img/icons/lock.png" title="{$row.steelitem.rel_title}" alt="{$row.steelitem.rel_title}"></a>{else}<img src="/img/icons/lock.png" title="{$row.steelitem.inuse_by}" alt="{$row.steelitem.inuse_by}">{/if}</td>
            <td>{if !empty($row.steelitem.properties.heat_lot)}{$row.steelitem.properties.heat_lot|escape:'html'}{/if}</td>
            <td>{if $row.steelitem.properties.c != 0}{$row.steelitem.properties.c|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.si != 0}{$row.steelitem.properties.si|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.mn != 0}{$row.steelitem.properties.mn|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.p != 0}{$row.steelitem.properties.p|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.s != 0}{$row.steelitem.properties.s|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.cr != 0}{$row.steelitem.properties.cr|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.ni != 0}{$row.steelitem.properties.ni|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.cu != 0}{$row.steelitem.properties.cu|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.al != 0}{$row.steelitem.properties.al|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.mo != 0}{$row.steelitem.properties.mo|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.nb != 0}{$row.steelitem.properties.nb|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.v != 0}{$row.steelitem.properties.v|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.n != 0}{$row.steelitem.properties.n|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.ti != 0}{$row.steelitem.properties.ti|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.sn != 0}{$row.steelitem.properties.sn|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.b != 0}{$row.steelitem.properties.b|escape:'html'}{else}0.000{/if}</td>
            <td>{if $row.steelitem.properties.ceq != 0}{$row.steelitem.properties.ceq|escape:'html'}{else}0.000{/if}</td>            
        {else}        
            <td>{if empty($row.steelitem.id)}*{else}{$row.steelitem.id}{/if}<input type="hidden" name="item_property[{$smarty.foreach.i.index + 1}][id]" value="{$row.steelitem.id}"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][heat_lot]" value="{if !empty($row.steelitem.properties.heat_lot)}{$row.steelitem.properties.heat_lot|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][c]" value="{if $row.steelitem.properties.c != 0}{$row.steelitem.properties.c|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][si]" value="{if $row.steelitem.properties.si != 0}{$row.steelitem.properties.si|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][mn]" value="{if $row.steelitem.properties.mn != 0}{$row.steelitem.properties.mn|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][p]" value="{if $row.steelitem.properties.p != 0}{$row.steelitem.properties.p|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][s]" value="{if $row.steelitem.properties.s != 0}{$row.steelitem.properties.s|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][cr]" value="{if $row.steelitem.properties.cr != 0}{$row.steelitem.properties.cr|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][ni]" value="{if $row.steelitem.properties.ni != 0}{$row.steelitem.properties.ni|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][cu]" value="{if $row.steelitem.properties.cu != 0}{$row.steelitem.properties.cu|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][al]" value="{if $row.steelitem.properties.al != 0}{$row.steelitem.properties.al|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][mo]" value="{if $row.steelitem.properties.mo != 0}{$row.steelitem.properties.mo|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][nb]" value="{if $row.steelitem.properties.nb != 0}{$row.steelitem.properties.nb|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][v]" value="{if $row.steelitem.properties.v != 0}{$row.steelitem.properties.v|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][n]" value="{if $row.steelitem.properties.n != 0}{$row.steelitem.properties.n|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][ti]" value="{if $row.steelitem.properties.ti != 0}{$row.steelitem.properties.ti|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][sn]" value="{if $row.steelitem.properties.sn != 0}{$row.steelitem.properties.sn|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][b]" value="{if $row.steelitem.properties.b != 0}{$row.steelitem.properties.b|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][ceq]" value="{if $row.steelitem.properties.ceq != 0}{$row.steelitem.properties.ceq|escape:'html'}{/if}" style="width: 100%;"></td>
        {/if}
        </tr>
        {/foreach}
    </tbody>
</table>
<div class="pad"></div>

<h3>Mechanical Properties</h3>
<table id="t-im" class="list" width="100%">
    <tbody>
        <tr class="top-table" style="height: 25%;">
            <th width="2%" rowspan="2">Id</th>
            <th colspan="4" style="border-bottom : 1px solid #B9B9B9;">Tensile</th>
            <th rowspan="2">{*Reduction Of Area*} Z-test, %</th>
            <th colspan="3" style="border-bottom : 1px solid #B9B9B9;">Impact</th>
            <th rowspan="2">Hardness<br>HD</th>
            <th rowspan="2">UST</th>
            <th rowspan="2">Stress Relieving Temp<br>deg. C</th>
            <th rowspan="2">Heating Rate Per Hour<br>deg. C</th>
            <th rowspan="2">Holding Time<br>Hours</th>
            <th rowspan="2">Cooling Down Rate Per Hour<br>deg. C</th>
            <th rowspan="2">Normalizing Temp<br>deg. C</th>
            <th rowspan="2">Condition</th>
        </tr>
        <tr class="top-table" style="height: 25%;">
            <th>Sample Direction</th>            
            <th>Strength<br>N/mm<sup>2</sup></th>
            <th>Yield Point<br>N/mm<sup>2</sup></th>
            <th>Elongation<br>%</th>
            <th>Sample Direction</th>
            <th>Test Temp<br>deg. C</th>
            <th>Strength<br>J/cm<sup>2</sup></th>
        </tr>
        {foreach name=i from=$items item=row}
        <tr>
        {if $row.steelitem.inuse || $row.steelitem.parent_id > 0}
            <td>{if $row.steelitem.parent_id > 0}<a href="/item/edit/{$row.steelitem.parent_id}"><img src="/img/icons/lock.png" title="{$row.steelitem.rel_title}" alt="{$row.steelitem.rel_title}"></a>{else}<img src="/img/icons/lock.png" title="{$row.steelitem.inuse_by}" alt="{$row.steelitem.inuse_by}">{/if}</td>
            <td>{if !empty($row.steelitem.properties.tensile_sample_direction)}{$row.steelitem.properties.tensile_sample_direction|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.tensile_strength)}{$row.steelitem.properties.tensile_strength|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.yeild_point)}{$row.steelitem.properties.yeild_point|escape:'html'}{/if}</td>
            <td>{if $row.steelitem.properties.elongation != 0}{$row.steelitem.properties.elongation|escape:'html'}{/if}</td>
            <td>{if $row.steelitem.properties.reduction_of_area != 0}{$row.steelitem.properties.reduction_of_area|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.sample_direction)}{$row.steelitem.properties.sample_direction|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.test_temp)}{$row.steelitem.properties.test_temp|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.impact_strength)}{$row.steelitem.properties.impact_strength|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.hardness)}{$row.steelitem.properties.hardness|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.ust)}{$row.steelitem.properties.ust|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.stress_relieving_temp)}{$row.steelitem.properties.stress_relieving_temp|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.heating_rate_per_hour)}{$row.steelitem.properties.heating_rate_per_hour|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.holding_time)}{$row.steelitem.properties.holding_time|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.cooling_down_rate)}{$row.steelitem.properties.cooling_down_rate|escape:'html'}{/if}</td>
            <td>{if !empty($row.steelitem.properties.normalizing_temp)}{$row.steelitem.properties.normalizing_temp|escape:'html'}{/if}</td>
            <td>
                {if $row.steelitem.properties.condition == 'ar'}As Rolled
                {elseif $row.steelitem.properties.condition == 'n'}Normalized
                {elseif $row.steelitem.properties.condition == 'nr'}Normalizing Rolling{/if}
            </td>
        {else}
            <td>{if empty($row.steelitem.id)}*{else}{$row.steelitem.id}{/if}</td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][tensile_sample_direction]" value="{if !empty($row.steelitem.properties.tensile_sample_direction)}{$row.steelitem.properties.tensile_sample_direction|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][tensile_strength]" value="{if !empty($row.steelitem.properties.tensile_strength)}{$row.steelitem.properties.tensile_strength|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][yeild_point]" value="{if !empty($row.steelitem.properties.yeild_point)}{$row.steelitem.properties.yeild_point|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][elongation]" value="{if $row.steelitem.properties.elongation != 0}{$row.steelitem.properties.elongation|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][reduction_of_area]" value="{if $row.steelitem.properties.reduction_of_area != 0}{$row.steelitem.properties.reduction_of_area|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][sample_direction]" value="{if !empty($row.steelitem.properties.sample_direction)}{$row.steelitem.properties.sample_direction|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][test_temp]" value="{if !empty($row.steelitem.properties.test_temp)}{$row.steelitem.properties.test_temp|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][impact_strength]" value="{if !empty($row.steelitem.properties.impact_strength)}{$row.steelitem.properties.impact_strength|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][hardness]" value="{if !empty($row.steelitem.properties.hardness)}{$row.steelitem.properties.hardness|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][ust]" value="{if !empty($row.steelitem.properties.ust)}{$row.steelitem.properties.ust|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][stress_relieving_temp]" value="{if !empty($row.steelitem.properties.stress_relieving_temp)}{$row.steelitem.properties.stress_relieving_temp|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][heating_rate_per_hour]" value="{if !empty($row.steelitem.properties.heating_rate_per_hour)}{$row.steelitem.properties.heating_rate_per_hour|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][holding_time]" value="{if !empty($row.steelitem.properties.holding_time)}{$row.steelitem.properties.holding_time|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][cooling_down_rate]" value="{if !empty($row.steelitem.properties.cooling_down_rate)}{$row.steelitem.properties.cooling_down_rate|escape:'html'}{/if}" style="width: 100%;"></td>
            <td><input type="text" name="item_property[{$smarty.foreach.i.index + 1}][normalizing_temp]" value="{if !empty($row.steelitem.properties.normalizing_temp)}{$row.steelitem.properties.normalizing_temp|escape:'html'}{/if}" style="width: 100%;"></td>
            <td>
                <select name="item_property[{$smarty.foreach.i.index + 1}][condition]" style="width: 100%;">
                    <option value="">--</option>
                    <option value="ar"{if $row.steelitem.properties.condition == 'ar'} selected="selected"{/if}>As Rolled</option>
                    <option value="n"{if $row.steelitem.properties.condition == 'n'} selected="selected"{/if}>Normalized</option>
                    <option value="nr"{if $row.steelitem.properties.condition == 'nr'} selected="selected"{/if}>Normalizing Rolling</option>
                </select>
            </td>        
        {/if}
        </tr>
        {/foreach}
    </tbody>
</table>