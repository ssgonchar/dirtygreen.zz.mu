(function() {
 // Lзагружаем языковый пакет

 tinymce.create('tinymce.plugins.MicsLink', {
  /**
   * инициализируем плагин 
   * ed - экземляр редактора 
   * url - абсолютный url плагина 
   */
  init : function(ed, url) {
   // Регестрирум комаду, для открытия окна плагина
    ed.addCommand('mceMics', function() {
    //  параметры окна
    ed.windowManager.open({
     file: url + '/dialog.htm',
     width: 320 + ed.getLang('mics_link.delta_width', 0),
     height: 120 + ed.getLang('mics_link.delta_height', 0),
     inline: 1
    }, {
     // данные для плагина - его абсолютный URL
     // и аргументы (ели они нужны)
     plugin_url : url,
     some_custom_arg : 'custom arg'
    });
   });
 
   // регестрируем иконку плагина
   ed.addButton('mics_link', {
    title: 'mics_link.desc',
    cmd: 'mceMics',
    image: url + '/img/mics_link.gif'
   });
 
    ed.onNodeChange.add(function(ed, cm, n) {
    cm.setActive('mics_link', n.nodeName == 'IMG');
   });
  },
 
   createControl : function(n, cm) {
   return null;
  },
 
  // "Выходные данные" плагина
  getInfo : function() {
   return {
    longname : 'Mics Link Plugin',
    author: 'Geol',
    authorurl: 'http://webgeol.blogspot.com/',
    version: "1.0"
   };
  }
 });
 
 // Регестрируем плагин
   tinymce.PluginManager.add('mics_link', tinymce.plugins.MicsPlugin);
})();