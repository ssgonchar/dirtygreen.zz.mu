Привет!

Необходимо разработать молдуль Release Advice.

1. Взять последнюю версию из репозитория и БД из 
/usr/home/mam/20120930.mam.data.sql и /usr/home/mam/20120930.mam.routines.sql


2. Добавить таблицы: 
ra
--
id
number			INT
stockholder_id	INT
company_id		INT
truck_number	VARCHAR(50)
marking			TEXT
dunnaging		TEXT
status_id		INT				{1 - RA_STATUS_OPEN, 2 - RA_STATUS_CLOSED}
max_weight		DECIMAL(10,4)	- максимальный вес, unitweight весех айтемов * 6%
weighed_weight	DECIMAL(10,4)
ddt_id			INT
created_at
created_by
modified_at
modified_by


ra_items
--------
id
ra_id
itesm_id
parent_id
created_at
created_by
modified_at
modified_by


3. На страницу /orders добавить чекбоксы для заказов со статусом 'ip' (In Processing)
	в футер страницы добавить кнопку Create RA рядом с кнопкой Create New.
	При нажатии нужно:
	- получить все айтемы со статусом < ITEM_STATUS_RELEASED из выделенных заказов
	- сформировать из них строку {item_id},{item_id},{item_id},...
	- сделать редирект на страницу /ra/add/{items_id}

	
4. Создать контроллер ra_main.class.php и метод ra_main.class.php::add, который обрабатывает ссылку /ra/add/{items_id}
	создать для него шаблоны: /html/ra/main_add.tpl, /html/ra/context_add.tpl. На этой странице отобразить список айтемов
	из {items_id} разбитый на группы по stockholder_id. Таблица айтемов должна содержать поля:
	- чекбокс, id, guid, thickness, width, length, weight, id_ddt_number, in_ddt_date, ddt_number, dt_date.
	
	Общий вид страницы:
	НАЗВАНИЕ СТОКХОЛДЕРА
	таблица
	
	НАЗВАНИЕ СТОКХОЛДЕРА
	таблица
	
	Внизу кнопка: "Create". При нажатии создается стоько RA в скольких стокхолдерах выбраны айтемы и пользователь переводится на странцу
	редактирования первого из созданых /ra/{ra_id}/edit

5. На странице редактирования:
	- stockholder_id 	{текст}
	- company_id		{input с автозаполнением}
	- truck_number		{input}
	- marking			{textarea}
	- dunnaging			{textarea}
	- max_weight		{текст}
	- weighed_weight	{input}
	- таблица айтемов: 
		- id, 
		- guid, 
		- thickness, 
		- width, 
		- length, 
		- weight, 
		- id_ddt_number, 
		- in_ddt_date, 
		- ddt_number, 
		- dt_date
		- add variant {ссылка}
		
	При нажатии на ссылку "add variant" в строке айтема должно появиться окно, для выбора альтернатив - других айтемов 
	из позиции оригинального айтема со статусами < ITEM_STATUS_RELEASED. В этом окне будет таблица айтемов:
	- чекбокс, id, guid, id_ddt_number, in_ddt_date, ddt_number, dt_date
	- кнопка "Add", при нажатии выбранные айтемы должны добавиться в таблицу айтемов под строку айтема, 
	для которого выполнялось добавление	с небольшим смещением, чтобы было понятно где основные айтемы, а где альтернативы.
		
	Внизу кнопка "Save", при нажатии должны сохраняться значения формы в таблицу ra, а таблицы айтемов в ra_items,
	причем альтернативыне айтемы должны сохраняться с parent_id = id основного айтема. Должен генерироваться PDF. 
	
6. Пример PDF пришлю отдельно.


Deadline:  13.10.2012