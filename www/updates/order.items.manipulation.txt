Действия:
(+) 1. Добавление позиции в заказ.
	(+) 1.1. Проверка доступного количества позиции.
	(+) 1.2. Обновление данных позиции в заказе.
	(+) 1.3. Создание или удаление айтемов для позиции созданной в заказе.
	(+) 1.4. Добавление или удаление айтемов в заказ.
(+) 2. Удаление позиции из заказа
	(+) 2.1. Удаление позиции из заказа
	(+) 2.2. Удаление айтемов для позиций созданных в заказе
	(+) 2.3. Удаление позиций созданных в заказе
	(+) 2.4. Удаление айтемов из заказа
(+) 3. Добавление айтема в заказ.
(+) 4. Удаление айтема из заказа.


Проверка:
- добавление дублирующих айтемов
- отображение конфликтующих
- проверка и отображение заказов с конфликтующими айтемами (при просмотре заказа, в списке заказов)
- ссылка с отображением комплектующих
- отмена заказа
- перераспределение айтемов
- удаление позиций зазаза
- добавление напрямую
- добавление со склада
- проверка изменения состояния списков позиций и айтемов при is_locked = 1


добавить steelposition.is_locked


(+) order_positions.is_order_conflicted
(+) steelitems.is_order_conflicted
(+) order.is_order_conflicted

steelposition.is_deleted
steelitems.is_deleted

(!) При назначении айтемов к заказу приоритет отдавать реальным (parent_id = 0)


1. При сохранении заказа запускать функцию CheckOrderConflict(order_id) :
	- проверяет айтемы заказа и ищет родственников parent_id > 0 ? (where item.parent_id = parent_id OR id = parent_id) : (where item.parent_id = id)
		если родственники найдены в заказе, то айтемы, позиции заказа и сам заказ помечаются как is_order_conflict = 1,
		если родственники найдены за пределами заказов они помечаются как удаленные.
	- для всех айтемов заказа и их родственников проводится ревизия количества позиций, позиции в которых находятся только удаленные айтемы
		помечаются как удаленные.
		
2. При переназначении айтемов в заказ на странице выбора айтемов нужно:
	- для освободившихся айтемов возвращать всех родственников, снимать им is_deleted = 0 и is_order_conflict = 0
	- для занятых айтемов проводить проверку всех родственников с пометкой о конфликте (п. 1).
	
3. Когда статус айтема меняется на delivered:
	- все рдоственники которые были помечены как is_deleted удаляются
	- айтем натурализуется: ставится parent_id = 0, все свойства переносятся из parent-а
	
4. При удалении позиции из заказа:

5. При отмене заказа:

6. При изменении статуса заказа на "Выполнен" :
	


При назначении айтемов к заказу на странице /order/selectitems/{order_id}/position:{position_id} : 
sp_order_add_item
sp_order_remove_item
	
	
	

		